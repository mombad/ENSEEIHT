with registre;
with Ada.Text_IO;            use Ada.Text_IO;
with Ada.Integer_Text_IO;    use Ada.Integer_Text_IO;
with Ada.Unchecked_Deallocation;
with Arbre_Binaire;
with registre;

package body Arbre_genealogique is

    package Arbre_genealogique is
            new Arbre_Binaire( T_Cle => Integer);
    function inferieur (Cle1: Integer; Cle2: Integer) return Boolean is
    begin
        return (Cle1 < Cle2);
    end inferieur;

    procedure Initialiser_Arbre_Gen(A : out T_Arbre_Gen;R: out T_Registre) is
    begin
        Initialiser_Arbre(A);
        Initialiser_R (R);
    end Initialiser_Arbre_Gen;

    procedure Ajouter_Arbre_Gen(A: in out T_Arbre_Gen;R: in out T_Registre; Cle_parent: in Integer ;Cle_enfant: in Integer; choix: in Boolean) is
    begin
        Ajouter(A,Cle_parent,Cle_enfant,Choix);
        Ajouter_R_individu(R,Cle_parent);
        Ajouter_R_info(R,Cle_parent);
    end Ajouter_Arbre_Gen;

    function Obtenir_nb_ancetres(A: in T_Arbre_Gen; Cle: in Integer) return Integer is
        procedure chercher_Cle(A: in T_Arbre_Gen; A1: in out T_Arbre_Gen; Cle: in Integer) is
        begin
            if A.all.Cle = Cle then --Cle trouvÃ©
                A1 := A;
            elsif A.all.Cle < Cle then
                Chercher_Cle(A.all.gauche,A1,Cle);
            elsif A.all.Cle > Cle then
                Chercher_Cle(A.all.droite,A1,Cle);
            else
                raise Est_Absent_Cle;
            end if;

        end chercher_Cle;
    begin
        declare
                    A1 : T_Arbre_Gen;
                    A2: T_Arbre_Gen;
        begin
             chercher_Noeud(A,A1,Cle);
                    if A1 = Null then
                        return 0;
                    elsif A1.all.gauche = Null and A1.all.droite = Null then
                        return 1 + Obtenir_nb_ancetres(A1.all.gauche,Cle) + Obtenir_nb_ancetres(A1.all.droite,Cle);
                    else
                        return 2 + Obtenir_nb_ancetres(A1.all.gauche,Cle) + Obtenir_nb_ancetres(A1.all.droite,Cle);
                    end if;
                end;

            end Obtenir_nb_ancetres;
        end Arbre_genealogique;
